{% extends "base.html" %}

{% block title %} Blog {% endblock%}

{% block content %}
<!-- blog -->
<div class="section section-blog">
  <!-- section title -->
  <div class="bloglist-header">
    <div class="center">
      <h2>blog</h2>
      <div class="underline"></div>
    </div>
    <div class="search-container">
      <form method="POST" action="/blog/" id="search-form">
        <input class="search" type="text" name="search" placeholder="Search article...">
        <input class="hidden-btn" type="submit" id="search-btn">
      </form>
    </div>
  </div>
  <!-- end of section title -->
  <div class="section-center">
    <h3 class="current-search">
      {% if search %}
        Search for: <span class="search-display">{{ search }}</span>
      {% else %}
        All articles
      {% endif %}
      </h3>
    <div class="blog-center">
      {% for post in posts %}
        <!-- single article -->
        <div class="card">
          <div class="card-side card-front">
            <!-- front of the card -->
            <div class="blog-card-img">
              <img src="{{ config['IMAGE_UPLOADS_REL'] }}/{{ post['imagename'] }}" alt="">
              <div class="reading-time"> {{reading_min}} min read</div>
            </div>
            <div class="card-info">
              <h4>{{post['title']}}</h4>
              <p>{{post['intro']}}</p>
              <div class="card-footer">
                <div class="tags">
                  {% for tag in post["tags"] %}
                    <span class="tag">{{tag}}</span>
                  {% endfor %}
                </div>
                <p>{{(post['created'] | string )[2:10] }}</p>
              </div>
            </div>
          </div>
          <!-- end of front of the card -->

          <!-- back of the card -->
          <div class="card-side card-back">
              <div class="article-beginning">
                <div class="fade-out"></div>
                {%- for p in post["body"] -%}
                  {% if p == "" %}
                    <br>
                  {% endif %}
                  <p>{{ p }}</p>
                {%- endfor -%}
                <a href="{{ url_for('blog.single_article_view', id=post['id'], title=post['title']| lower | replace(" ", "-")) }}" class="btn read-more">read more</a>
              </div>
              <div class="tags">
                {% for tag in post["tags"] %}
                  <a class="tag-back" href="{{ url_for('blog.bloglist_view', search=tag.lower(), _method='GET') }}">
                    {{tag}}
                  </a>
                {% endfor %}
              </div>
          </div>
          <!-- end of back of the card -->
        </div>
        <!-- end of single article -->
      {% endfor %}
    </div>
  </div>
  {% if g.user %}
    <div class="btn-center">
      <a class="action btn" href="{{ url_for('blog.create_view') }}"> new article</a>
    </div>
  {% endif %}
  {% if search%}
    <div class="btn-center">
      <a class="action btn" href="{{ url_for('blog.bloglist_view') }}"> All articles</a>
    </div>
  {% endif %}
</div>
<!--end of  blog -->
{% endblock %}
